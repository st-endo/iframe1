<!DOCTYPE html>
<html>
<head>
    <title>サイトA</title>
    <script>
        let redDiv;

        window.addEventListener('DOMContentLoaded', (event) => {
            const iframes = document.querySelectorAll('iframe');
            iframes.forEach(iframe => {
                iframe.addEventListener('load', function() {
                    const specialElementId = this.getAttribute('data-element-id');
                    const frameId = this.getAttribute('id');
                    this.contentWindow.postMessage({ specialElementId, frameId }, '*');
                });
            });
        });

        window.addEventListener('message', function(event) {
            const data = event.data;
            if (typeof data === 'object' && data !== null && 'id' in data) {
                const iframe = document.querySelector(`#${data.id}`);
                if (iframe) {
                    if (data.action === 'show' && 'rect' in data) {
                        redDiv = document.createElement('div');
                        redDiv.style.width = '200px';
                        redDiv.style.height = '200px';
                        redDiv.style.background = 'red';
                        redDiv.style.position = 'absolute';
                        redDiv.style.left = `${data.rect.right + iframe.offsetLeft}px`;
                        redDiv.style.top = `${data.rect.top + iframe.offsetTop}px`;
                        document.body.appendChild(redDiv);
                    } else if (data.action === 'hide' && redDiv) {
                        document.body.removeChild(redDiv);
                        redDiv = null;
                    }
                }
            }
        }, false);
    </script>
</head>
<body>
    <iframe id="frame1" data-element-id="btn1" src="http://localhost:8081" style="position:relative;"></iframe>
</body>
</html>
